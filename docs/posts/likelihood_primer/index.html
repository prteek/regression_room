<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prateek">
<meta name="dcterms.date" content="2024-12-28">

<title>Blog - A primer on Likelihood</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Prateek</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/prteek"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">A primer on Likelihood</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">likelihood</div>
                <div class="quarto-category">statistics</div>
                <div class="quarto-category">theory</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Prateek </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 28, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#likelihood" id="toc-likelihood" class="nav-link" data-scroll-target="#likelihood">Likelihood</a>
  <ul class="collapse">
  <li><a href="#discrete-rv-case" id="toc-discrete-rv-case" class="nav-link" data-scroll-target="#discrete-rv-case">Discrete RV case</a></li>
  <li><a href="#continuous-rv-case" id="toc-continuous-rv-case" class="nav-link" data-scroll-target="#continuous-rv-case">Continuous RV case</a></li>
  </ul></li>
  <li><a href="#binomial-example" id="toc-binomial-example" class="nav-link" data-scroll-target="#binomial-example">Binomial example</a></li>
  <li><a href="#fisher-information-uncertainty" id="toc-fisher-information-uncertainty" class="nav-link" data-scroll-target="#fisher-information-uncertainty">Fisher Information (uncertainty)</a>
  <ul class="collapse">
  <li><a href="#fisher-information-for-binomial" id="toc-fisher-information-for-binomial" class="nav-link" data-scroll-target="#fisher-information-for-binomial">Fisher information for Binomial</a></li>
  <li><a href="#effect-of-fisher-information-on-log-likelihood" id="toc-effect-of-fisher-information-on-log-likelihood" class="nav-link" data-scroll-target="#effect-of-fisher-information-on-log-likelihood">Effect of Fisher information on log-likelihood</a></li>
  </ul></li>
  <li><a href="#numerical-estimation" id="toc-numerical-estimation" class="nav-link" data-scroll-target="#numerical-estimation">Numerical estimation</a>
  <ul class="collapse">
  <li><a href="#normal-example" id="toc-normal-example" class="nav-link" data-scroll-target="#normal-example">Normal example</a></li>
  <li><a href="#binomial-solution" id="toc-binomial-solution" class="nav-link" data-scroll-target="#binomial-solution">Binomial solution</a></li>
  </ul></li>
  <li><a href="#wrap-up" id="toc-wrap-up" class="nav-link" data-scroll-target="#wrap-up">Wrap up</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Likelihood is a fundamental concept that plays a pivotal role in parameter estimation and model fitting. <br> Whether one is estimating the parameters of a simple distribution or building complex statistical models, likelihood functions provide a way to quantify how likely a set of observed data is, given specific model parameters. <br> In this post, I’ll break down the concept of likelihood, explore how it relates to probability, and demonstrate its application in parameter estimation using methods of Maximum Likelihood Estimation (MLE) and Newton Raphson. <br> This primer will help bring clarity to working with Likelihoods for parameter estimation. <br> The concepts discussed are deeply inspired by <span class="citation" data-cites="extending_lm_with_R_book">(<a href="#ref-extending_lm_with_R_book" role="doc-biblioref">Faraway 2016</a>)</span> and <span class="citation" data-cites="statistical_inference">(<a href="#ref-statistical_inference" role="doc-biblioref">George Casella 2002</a>)</span>. For a more comprehensive understanding of the subject, I highly recommend reading the full texts.</p>
</section>
<section id="likelihood" class="level2">
<h2 class="anchored" data-anchor-id="likelihood">Likelihood</h2>
<section id="discrete-rv-case" class="level3">
<h3 class="anchored" data-anchor-id="discrete-rv-case">Discrete RV case</h3>
<p>If we consider there to be a set of independent <strong>discrete</strong> random variables <span class="math inline">\(Y_1,...., Y_n\)</span> with probability mass function <span class="math inline">\(f(y|\theta)\)</span> where <span class="math inline">\(\theta\)</span> is the parameter. <br> Let <span class="math inline">\(\mathbf{y} = (y_1,....,y_n)^T\)</span> be the observed values, then the <em>likelihood</em> function for the distribution is:</p>
<p><span class="math display">\[
P(\mathbf{Y}=\mathbf{y}) = \prod_{i=1}^{n} f(y_i|\theta) = L(\theta|y)
\]</span></p>
<p>As can be seen likelihood is about considering parameter <span class="math inline">\(\theta\)</span> as random and data <span class="math inline">\(\mathbf{y}\)</span> as fixed (hence the notation <span class="math inline">\(L(\theta|y)\)</span>). This is as opposed to a joint density function where <span class="math inline">\(\theta\)</span> are fixed and <span class="math inline">\(y\)</span> are random. <br> Effectively though <em>likelihood</em> is still the probability of observed data <span class="math inline">\(\mathbf{y}\)</span> for a specified value of the parameter(s) i.e.&nbsp;<span class="math inline">\(p(\mathbf{y}|\theta)\)</span> but the key distinction is that <em>likelihood</em> changes as <span class="math inline">\(\theta\)</span> changes.</p>
</section>
<section id="continuous-rv-case" class="level3">
<h3 class="anchored" data-anchor-id="continuous-rv-case">Continuous RV case</h3>
<p>When the random variables are <strong>continuous</strong> (with probability density <span class="math inline">\(f(y|\theta)\)</span>), in practice one can measure data with limited precision. When a value <span class="math inline">\(y_i\)</span> is observed it effectively indicates an observation in the range <span class="math inline">\([y_i^l, y_i^u]\)</span>, where <span class="math inline">\(y_i^l\)</span> and <span class="math inline">\(y_i^u\)</span> are lower and upper bounds of precision limit. <br> Using which we can reason that probability of observed value is a concept defined over an interval:</p>
<p><span class="math display">\[
P(Y_i=y_i) = P(y_i^l&lt;=y_i&lt;=y_i^u) = \int_{y_i^l}^{y_i^u} f(u|\theta) \, du \approx f(y_i|\theta) \delta_i
\]</span></p>
<p>such that <span class="math inline">\(\delta_i = y_i^u-y_i^l\)</span>, which does not depend on <span class="math inline">\(\theta\)</span> and is related to the precision of measurement. <br> And, the likelihood becomes:</p>
<p><span class="math display">\[
L(\theta|y) \approx \prod_{i=1}^{n} f(y_i|\theta) \prod_{i=1}^{n}\delta_i
\]</span></p>
<p>Given we know that <span class="math inline">\(\delta_i\)</span> does not depend on <span class="math inline">\(\theta\)</span>, the last term can be ignored and the likelihood then becomes same as in the discrete case. <br></p>
</section>
</section>
<section id="binomial-example" class="level2">
<h2 class="anchored" data-anchor-id="binomial-example">Binomial example</h2>
<p>Let’s consider a binomially distributed random variable <span class="math inline">\(Y \sim B(n,p)\)</span> (Note: here <span class="math inline">\(p\)</span> is the parameter of interest). <br> Its likelihood is:</p>
<p><span class="math display">\[
L(p|y) = \binom{n}{y}p^y(1-p)^{n-y}
\]</span></p>
<p>The <em>maximum likelihood</em> estimate (MLE) of <span class="math inline">\(p\)</span> results in the largest probability of observed data. The value at which the maximum occurs is called the maximum likelihood estimate and is denoted as <span class="math inline">\(\hat{p}\)</span>.</p>
<p>Often, it is simpler to maximise the log of likelihood function <span class="math inline">\(l(\theta|y) = log(L(\theta|y))\)</span>, considering that <em>log</em> is a monotonic increasing function so maximising either should result in the exact same estimate <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p>To find the solution for <span class="math inline">\(\hat{p}\)</span> in our binomial case, we can start by defining the log-likelihood:</p>
<p><span class="math display">\[
l(p|y) = log(\binom{n}{y}) + ylog(p) + (n-y)log(1-p)
\]</span></p>
<p>A typical calculus approach to maximising this function would be to take the derivative of this log-likelihood w.r.t. parameters of interest and set it to 0. <br> Worth noting that the derivative is called <em>score function</em> and denoted as <span class="math inline">\(u(\theta)\)</span> in general. For binomial we have:</p>
<p><span class="math display">\[
u(p) = \frac{d}{dp}l(p|y) = \frac{y}{p} - \frac{n-y}{1-p}
\]</span></p>
<p>To get the maximum likelihood estimate <span class="math inline">\(\hat{p}\)</span> we solve for <span class="math inline">\(u(p) = 0\)</span> and get <span class="math inline">\(\hat{p} = y/n\)</span>.</p>
</section>
<section id="fisher-information-uncertainty" class="level2">
<h2 class="anchored" data-anchor-id="fisher-information-uncertainty">Fisher Information (uncertainty)</h2>
<p>Some measure of uncertainty is desirable here to be able to rely on the estimate. This is given by Fisher information:</p>
<p><span class="math display">\[
I(\theta) = var(u(\theta)) = -\mathbb{E}[\frac{\partial^2}{\partial \theta \partial \theta^T}l(\theta)]
\]</span></p>
<p>The double derivative part here implies the rate of change of <em>score</em> itself. <br> At (or near) the maximum values of <em>score</em>, a large value of <span class="math inline">\(I(\theta)\)</span> effectively indicates a large rate of change of <em>score</em>. Which means that the maximum is well defined (curvature of score is large) which would indicate a high level of confidence in the estimate.</p>
<p>Under regularity conditions, the maximum likelihood estimator (MLE) of the parameter <span class="math inline">\(\theta\)</span> , denoted as <span class="math inline">\(\hat{\theta}\)</span> , is asymptotically unbiased and normally distributed. That is: <span class="math display">\[
\hat{\theta} \sim \mathcal{N}\left(\theta, \frac{1}{I(\theta)}\right).
\]</span> and this means that <span class="math inline">\(var(\hat{\theta}) = I^{-1}(\theta)\)</span>. Which gives us the uncertainty on parameter estimate itself.</p>
<section id="fisher-information-for-binomial" class="level3">
<h3 class="anchored" data-anchor-id="fisher-information-for-binomial">Fisher information for Binomial</h3>
<p>Now, in the Fisher information, the expectation is w.r.t. data. Consider the following for binomial distributed data:</p>
<span class="math display">\[\begin{align}
    \frac{d}{dp}l(p|y) = \frac{y}{p} - \frac{n-y}{1-p} \\
    \frac{d^2}{dp}l(p|y)l(p|y) = -\frac{y}{p^2} - \frac{n-y}{(1-p)^2} \\
    \mathbb{E}[\frac{d^2}{dp}l(p|y)l(p|y)] = \mathbb{E}[-\frac{y}{p^2} - \frac{n-y}{(1-p)^2}] \\
    and, \mathbb{E}[y] = np \\
    \mathbb{E}[\frac{d^2}{dp}l(p|y)l(p|y)] = -\frac{n}{p} - \frac{n}{(1-p)} \\
    I(p) = - \mathbb{E}[\frac{d^2}{dp}l(p|y)l(p|y)] = \frac{n}{p} + \frac{n}{(1-p)} \\
    I(p) = \frac{n}{p(1-p)}

\end{align}\]</span>
<p>So, the larger the <span class="math inline">\(n\)</span> (sample size) the greater is Fisher information and lesser uncertainty about the maxima point of <em>score</em> function. Similarly, for same <span class="math inline">\(n\)</span> more extreme values of <span class="math inline">\(p\)</span> will enable estimation of parameter with greater degree of confidence due to higher Fisher Information. Intuitively, this is because extreme values in data will be observed (lots of 1s or lots or 0s).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="effect-of-fisher-information-on-log-likelihood" class="level3">
<h3 class="anchored" data-anchor-id="effect-of-fisher-information-on-log-likelihood">Effect of Fisher information on log-likelihood</h3>
<p>We can also illustrate the effect on <em>score</em> (log-likelihood) becoming more defined with higher Fisher information (due to higher <span class="math inline">\(n\)</span>) with same choices as above plot. <br> Essentially we consider 2 binomial datasets one with <span class="math inline">\(n=25, y=10\)</span> and another with <span class="math inline">\(n=50, y=20\)</span> where <span class="math inline">\(y\)</span> is observed counts of successes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>loglik <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, n) <span class="fu">lchoose</span>(n,y) <span class="sc">+</span> y<span class="sc">*</span><span class="fu">log</span>(x) <span class="sc">+</span> (n<span class="sc">-</span>y)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">loglik</span>(x,<span class="at">y=</span><span class="dv">10</span>,<span class="at">n=</span><span class="dv">25</span>), <span class="dv">0</span>,<span class="dv">1</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">'p'</span>, <span class="at">ylab=</span><span class="st">'Log-likelihood'</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">'Log-likelihood of Binomial distribution'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">loglik</span>(x,<span class="at">y=</span><span class="dv">20</span>,<span class="at">n=</span><span class="dv">50</span>), <span class="dv">0</span>,<span class="dv">1</span>, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"n=25"</span>, <span class="st">"n=50"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The maximum can be noticed at <span class="math inline">\(p=0.4\)</span> (equal to <span class="math inline">\(n/y\)</span> in both cases as derived earlier). For larger sample size <span class="math inline">\(n=50\)</span> the curvature is greater as there is more information in this case. <br> For our binomial example we maximised the log-likelihood function analytically earlier. It was a convenient exercise, however it is not always possible to analytically maximise log-likelihood and estimate parameters.</p>
</section>
</section>
<section id="numerical-estimation" class="level2">
<h2 class="anchored" data-anchor-id="numerical-estimation">Numerical estimation</h2>
<p>Typically numerical optimisation is necessary when estimating parameters using log-likelihood maximisation. The <em>Newton-Raphson</em> method is applied for these purposes. Consider <span class="math inline">\(\theta_0\)</span> as an initial guess for <span class="math inline">\(\theta\)</span>, then an update is made using: <span class="math display">\[
\theta_1 = \theta_0 - H^{-1}(\theta_0) J(\theta_0)
\]</span> Where, <br> <span class="math inline">\(H(\theta) = \frac{\partial^2}{\partial \theta \partial \theta^T}l(\theta)\)</span> is the Hessian matrix of second derivatives of log-likelihood w.r.t. <span class="math inline">\(\theta\)</span> . <br> <span class="math inline">\(J(\theta) = \frac{d}{d\theta}l(\theta)\)</span> is the Jacobian matrix of derivatives of log-likelihood w.r.t. <span class="math inline">\(\theta\)</span> .</p>
<p>This method works well, provided the log-likelihood is smooth and convex around the maximum and the initial value is reasonably chosen, but is not a guaranteed solution for all maximisation problems (such as when maximum is on boundary of parameter space or when there are several local maximums). <br></p>
<section id="normal-example" class="level3">
<h3 class="anchored" data-anchor-id="normal-example">Normal example</h3>
<p>To develop intuition on this method consider a Normal distribution: <span class="math display">\[
f(x \mid \mu, \sigma^2) = \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(x - \mu)^2}{2\sigma^2}\right)
\]</span></p>
<p>Its log-likelihood can be written as <span class="math display">\[
l(\mu) = -\frac{n}{2} \log(2\pi\sigma^2) - \frac{1}{2\sigma^2} \sum_{i=1}^n (x_i - \mu)^2.
\]</span></p>
<p>We calculate the first and second derivatives of log-likelihood</p>
<span class="math display">\[\begin{align}
l'(\mu) = \frac{\partial l(\mu)}{\partial \mu} = \frac{1}{\sigma^2} \sum_{i=1}^n (x_i - \mu) \\

l''(\mu) = \frac{\partial^2 l(\mu)}{\partial \mu^2} = -\frac{n}{\sigma^2}

\end{align}\]</span>
<p>Then we perform the <em>Newton Raphson</em> update</p>
<span class="math display">\[\begin{align}
\mu^{(t+1)} = \mu^{(t)} - \frac{l'(\mu^{(t)})}{l''(\mu^{(t)})} \\
\mu^{(t+1)} = \mu^{(t)} - \frac{\frac{1}{\sigma^2} \sum_{i=1}^n (x_i - \mu^{(t)})}{-\frac{n}{\sigma^2}} \\
\mu^{(t+1)} = \mu^{(t)} + \frac{\sum_{i=1}^n (x_i - \mu^{(t)})}{n} \\
\mu^{(t+1)} = \frac{1}{n} \sum_{i=1}^n x_i
\end{align}\]</span>
<p>Thus, in this case, the Newton-Raphson method directly converges to the sample mean <span class="math inline">\(\bar{x}\)</span> , which is the maximum likelihood estimate (MLE) for <span class="math inline">\(\mu\)</span>.</p>
</section>
<section id="binomial-solution" class="level3">
<h3 class="anchored" data-anchor-id="binomial-solution">Binomial solution</h3>
<p>Let’s now revert back to our Binomial distribution setting. We can perform log-likelihhod maximisation with <em>Newton Raphson</em> using <em>R</em>. Note that we need to minimize <span class="math inline">\(-l(\theta)\)</span> because <em>nlm</em> minimizes and doesn’t maximize.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="sc">-</span><span class="fu">loglik</span>(x, y, n)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>mle <span class="ot">&lt;-</span> <span class="fu">nlm</span>(f, <span class="fl">0.5</span>, <span class="at">hessian=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in log(x): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlm(f, 0.5, hessian = TRUE): NA/Inf replaced by maximum positive
value</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in log(x): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in nlm(f, 0.5, hessian = TRUE): NA/Inf replaced by maximum positive
value</code></pre>
</div>
</div>
<p>We use an initial value of <span class="math inline">\(p=0.5\)</span> and set <em>hessian</em> to TRUE to be able to calculate standard errors of the estimate using it.</p>
<p>At the MLE <span class="math inline">\(\hat{\theta}\)</span> , the Hessian <span class="math inline">\(H(\hat{\theta})\)</span> is often used as an estimate for the Fisher information. (since both are effectively double derivative of log-likelihood). We have <span class="math display">\[
I(\hat{\theta}) \approx -H(\hat{\theta})
\]</span> We have seen earlier that the variance of parameter is the inverse of Fisher information, which gives us <span class="math display">\[
\text{Var}(\hat{\theta}) = I^{-1}(\theta) \approx [-H(\hat{\theta})]^{-1}
\]</span></p>
<p>Hence, the inverse of the <em>Hessian</em> at the optimum is equal to the variance of the estimate. <br> Note: - sign is excluded since we’re working with -log-likelihood in <em>nlm</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Numerical estimate of p:"</span>, <span class="fu">round</span>(mle<span class="sc">$</span>estimate, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Numerical estimate of p: 0.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Estimated variance of p:"</span>, <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>mle<span class="sc">$</span>hessian, <span class="dv">4</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>act <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Actual variance variance of p:"</span>, <span class="fu">round</span>(<span class="fl">0.4</span><span class="sc">*</span>(<span class="dv">1</span><span class="fl">-0.4</span>)<span class="sc">/</span>n, <span class="dv">4</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(est, act, <span class="at">sep=</span><span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated variance of p: 0.0096
Actual variance variance of p: 0.0096</code></pre>
</div>
</div>
<p>This is a useful toolkit to have when working with estimations and maximum likelihood.</p>
</section>
</section>
<section id="wrap-up" class="level2">
<h2 class="anchored" data-anchor-id="wrap-up">Wrap up</h2>
<p>By understanding these fundamental concepts, one can gain deeper insights into statistical inference and model fitting, helping to make more informed decisions in real-world applications.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-extending_lm_with_R_book" class="csl-entry" role="listitem">
Faraway, Julian J. 2016. <em>Extending the Linear Model with r, Second Edition</em>. CRC Press.
</div>
<div id="ref-statistical_inference" class="csl-entry" role="listitem">
George Casella, Roger L. Berger. 2002. <em>Statistical Inference, Second Edition</em>. Cengage.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>